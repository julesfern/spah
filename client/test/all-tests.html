<!DOCTYPE html>
<html>
  <head>
    <title>Spah - all client tests</title>
    
    <script type="text/javascript" src="dependency/jquery.1.5.2.min.js"></script>
    <script type="text/javascript" src="dependency/mustache.js"></script>
    
    <script type="text/javascript" src="qunit/qunit.js"></script>
    <link rel="stylesheet" href="qunit/qunit.css" type="text/css">
    
    <!-- Libs -->
    <script type="text/javascript" src="../src/Spah.js"></script>
    <script type="text/javascript" src="../src/Spah.State.js"></script>
    <script type="text/javascript" src="../src/Spah.State.Merger.js"></script>
    
    <!-- Setup -->
    <script type="text/javascript">
      Spah.verbose = true;
    </script>    
    
    <!-- TESTS -->
    <script type="text/javascript" src="Spah.qunit.js"></script>
    <script type="text/javascript" src="Spah.State.qunit.js"></script>
    <script type="text/javascript" src="Spah.State.Merger.qunit.js"></script>
    <!-- /TESTS -->
  </head>
  <body>
    <h1 id="qunit-header">Spah - all client tests</h1>
    <h2 id="qunit-banner"></h2>
    <div id="qunit-testrunner-toolbar"></div>
    <h2 id="qunit-userAgent"></h2>
    <ol id="qunit-tests"></ol>
    <div id="qunit-fixture">
      
      <a href="/async" id="async_link">Async link</a>
      <a href="/sync" id="sync_link" data-async="false">Synchronous link</a>
      
      <script type="text/javascript">
        var Fixtures = {
          State: {
            
            Arrays: {
              target: {
                same: [0,"1",true,null],
                leave: [0,"1",true,null],
                modify: [0,"1",true,null],
                lengthen: [],
                shorten: [0,1,2,3],
                nullify: [0]
              },
              delta: {
                same: [0,"1",true,null],
                modify: [0,"1",false,3],
                lengthen: [0,1,2],
                shorten: [0],
                nullify: null
              },
              expected: {
                same: [0,"1",true,null],
                leave: [0,"1",true,null],
                modify: [0,"1",false,3],
                lengthen: [0,1,2],
                shorten: [0],
                nullify: null
              }
            },
            
            Hashes: {
              target: {
                same: {foo: "bar", bar: "baz"},
                leave: {foo: "bar", bar: "baz"},
                modify: {original: "original", leave: "leave"},
                lengthen: {},
                shorten: {foo: "bar", bar: "baz"},
                nullify: {foo: "bar", bar: "baz"}
              },
              delta: {
                same: {foo: "bar", bar: "baz"},
                modify: {original: "modified"},
                lengthen: {added: true},
                shorten: {foo: "bar", bar: null},
                nullify: null
              },
              expected: {
                same: {foo: "bar", bar: "baz"},
                leave: {foo: "bar", bar: "baz"},
                modify: {original: "modified", leave: "leave"},
                lengthen: {added: true},
                shorten: {foo: "bar", bar: null},
                nullify: null
              }
            },
            
            BaseTypes: {
              target: {
                sameStr: "same",
                leaveStr: "leave",
                modifyStr: "original",
                sameBool: true,
                leaveBool: false,
                modifyBool: false,
                sameNum: 1,
                leaveNum: 0,
                modifyNum: 0,
                nullify: "nullme"
              },
              delta: {
                sameStr: "same",
                modifyStr: "modified",
                sameBool: true,
                modifyBool: true,
                sameNum: 1,
                modifyNum: 1,
                nullify: null
              },
              expected: {
                sameStr: "same",
                leaveStr: "leave",
                modifyStr: "modified",
                sameBool: true,
                leaveBool: false,
                modifyBool: true,
                sameNum: 1,
                leaveNum: 0,
                modifyNum: 1,
                nullify: null
              }
            },
            
            
            Complex: {
              target: {
                modify: {
                  nullify: "not null",
                  str: "original",
                  array_leave: [0,1,2],
                  array_modify: [0,1,2,3,4,5],
                  array_shorten: [0,1,2,3,4,5],
                  bool: false,
                  obj_modify: {
                    foo: "foo original",
                    bar: "bar original"
                  }
                },
                leave: {
                  string: "original",
                  array: [0,1,3],
                  obj: {foo: "bar", bar: "baz"},
                  bool: false,
                  "null": null
                }
              },
              delta: {
                modify: {
                  nullify: null,
                  str: "modified",
                  array_modify: [0,1,2,"modified",4,null,"added"],
                  array_shorten: [0,1,2,3,4],
                  bool: true,
                  obj_modify: {
                    foo: "foo modified"
                  },
                  created: "i'm new!"
                },
                created: {
                  created_inner: "created"
                }
              }
            }
          }
        };
      </script>
    </div>
  </body>
</html>