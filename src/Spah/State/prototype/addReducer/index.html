<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>Spah  v0.0.0 API documentation | Spah.State#addReducer</title>
  <meta name="generator" content="PDoc" />
  
  <script charset="utf-8" src="../../../../javascripts/pdoc/prototype.js" type="text/javascript"></script>
  <script charset="utf-8" src="../../../../javascripts/pdoc/application.js" type="text/javascript"></script>
<script charset="utf-8" src="../../../../javascripts/pdoc/tabs.js" type="text/javascript"></script>
  <script charset="utf-8" src="../../../../javascripts/pdoc/item_index.js" type="text/javascript"></script>
  
  <link charset="utf-8" href="../../../../stylesheets/pdoc/api.css" media="screen, projection" rel="stylesheet" type="text/css" />
<link charset="utf-8" href="../../../../stylesheets/pdoc/pygments.css" media="screen, projection" rel="stylesheet" type="text/css" />
  
  <script type="text/javascript">
    PDoc.pathPrefix = '../../../../';
  </script>
</head>
  <body>

    <div id="sidebar">
      <ul id="sidebar_tabs" class="sidebar-tabs">
        <li>
          <a href="#menu_pane">Menu</a>
        </li>
        <li>
          <a href="#search_pane">Search</a>
        </li>
      </ul> <!-- .sidebar-tabs -->

      <form class="search-ribbon">
        <label>
          <span class="hidden">Search</span>
          <input type="text" id="search" size="20" title="Search" />
        </label>
      </form>
      
      <div class="sidebar-pane scrollable" id="menu_pane">
        <ul class="menu-items" id="api_menu"><li><div class="menu-item"><a class="class current-parent" href="../../../../Spah/index.html" title="Spah (class)">Spah</a></div><ul><li><div class="menu-item"><a class="class" href="../../../../Spah/DOM/index.html" title="Spah.DOM (class)">Spah.DOM</a></div><ul><li><div class="menu-item"><a class="class" href="../../../../Spah/DOM/Blueprint/index.html" title="Spah.DOM.Blueprint (class)">Spah.DOM.Blueprint</a></div></li>
<li><div class="menu-item"><a class="class" href="../../../../Spah/DOM/Document/index.html" title="Spah.DOM.Document (class)">Spah.DOM.Document</a></div></li>
<li><div class="menu-item"><a class="class" href="../../../../Spah/DOM/Errors/index.html" title="Spah.DOM.Errors (class)">Spah.DOM.Errors</a></div><ul><li><div class="menu-item"><a class="class" href="../../../../Spah/DOM/Errors/InvalidModifierError/index.html" title="Spah.DOM.Errors.InvalidModifierError (class)">Spah.DOM.Errors.InvalidModifierError</a></div></li></ul></li>
<li><div class="menu-item"><a class="class" href="../../../../Spah/DOM/Modifiers/index.html" title="Spah.DOM.Modifiers (class)">Spah.DOM.Modifiers</a></div><ul><li><div class="menu-item"><a class="class" href="../../../../Spah/DOM/Modifiers/ClassName/index.html" title="Spah.DOM.Modifiers.ClassName (class)">Spah.DOM.Modifiers.ClassName</a></div></li>
<li><div class="menu-item"><a class="class" href="../../../../Spah/DOM/Modifiers/ElementId/index.html" title="Spah.DOM.Modifiers.ElementId (class)">Spah.DOM.Modifiers.ElementId</a></div></li>
<li><div class="menu-item"><a class="class" href="../../../../Spah/DOM/Modifiers/Show/index.html" title="Spah.DOM.Modifiers.Show (class)">Spah.DOM.Modifiers.Show</a></div></li></ul></li></ul></li>
<li><div class="menu-item"><a class="class" href="../../../../Spah/SpahQL/index.html" title="Spah.SpahQL (class)">Spah.SpahQL</a></div><ul><li><div class="menu-item"><a class="class" href="../../../../Spah/SpahQL/Callbacks/index.html" title="Spah.SpahQL.Callbacks (class)">Spah.SpahQL.Callbacks</a></div></li>
<li><div class="menu-item"><a class="class" href="../../../../Spah/SpahQL/DataHelper/index.html" title="Spah.SpahQL.DataHelper (class)">Spah.SpahQL.DataHelper</a></div></li>
<li><div class="menu-item"><a class="class" href="../../../../Spah/SpahQL/Errors/index.html" title="Spah.SpahQL.Errors (class)">Spah.SpahQL.Errors</a></div><ul><li><div class="menu-item"><a class="class" href="../../../../Spah/SpahQL/Errors/SpahQLError/index.html" title="Spah.SpahQL.Errors.SpahQLError (class)">Spah.SpahQL.Errors.SpahQLError</a></div></li>
<li><div class="menu-item"><a class="class" href="../../../../Spah/SpahQL/Errors/SpahQLRunTimeError/index.html" title="Spah.SpahQL.Errors.SpahQLRunTimeError (class)">Spah.SpahQL.Errors.SpahQLRunTimeError</a></div></li></ul></li>
<li><div class="menu-item"><a class="class" href="../../../../Spah/SpahQL/Query/index.html" title="Spah.SpahQL.Query (class)">Spah.SpahQL.Query</a></div></li>
<li><div class="menu-item"><a class="class" href="../../../../Spah/SpahQL/QueryParser/index.html" title="Spah.SpahQL.QueryParser (class)">Spah.SpahQL.QueryParser</a></div></li>
<li><div class="menu-item"><a class="class" href="../../../../Spah/SpahQL/QueryResult/index.html" title="Spah.SpahQL.QueryResult (class)">Spah.SpahQL.QueryResult</a></div></li>
<li><div class="menu-item"><a class="class" href="../../../../Spah/SpahQL/QueryResultSet/index.html" title="Spah.SpahQL.QueryResultSet (class)">Spah.SpahQL.QueryResultSet</a></div></li>
<li><div class="menu-item"><a class="class" href="../../../../Spah/SpahQL/QueryRunner/index.html" title="Spah.SpahQL.QueryRunner (class)">Spah.SpahQL.QueryRunner</a></div></li>
<li><div class="menu-item"><a class="class" href="../../../../Spah/SpahQL/Token/index.html" title="Spah.SpahQL.Token (class)">Spah.SpahQL.Token</a></div><ul><li><div class="menu-item"><a class="class" href="../../../../Spah/SpahQL/Token/Base/index.html" title="Spah.SpahQL.Token.Base (class)">Spah.SpahQL.Token.Base</a></div></li>
<li><div class="menu-item"><a class="class" href="../../../../Spah/SpahQL/Token/Boolean/index.html" title="Spah.SpahQL.Token.Boolean (class)">Spah.SpahQL.Token.Boolean</a></div></li>
<li><div class="menu-item"><a class="class" href="../../../../Spah/SpahQL/Token/ComparisonOperator/index.html" title="Spah.SpahQL.Token.ComparisonOperator (class)">Spah.SpahQL.Token.ComparisonOperator</a></div></li>
<li><div class="menu-item"><a class="class" href="../../../../Spah/SpahQL/Token/FilterQuery/index.html" title="Spah.SpahQL.Token.FilterQuery (class)">Spah.SpahQL.Token.FilterQuery</a></div></li>
<li><div class="menu-item"><a class="class" href="../../../../Spah/SpahQL/Token/KeyName/index.html" title="Spah.SpahQL.Token.KeyName (class)">Spah.SpahQL.Token.KeyName</a></div></li>
<li><div class="menu-item"><a class="class" href="../../../../Spah/SpahQL/Token/Numeric/index.html" title="Spah.SpahQL.Token.Numeric (class)">Spah.SpahQL.Token.Numeric</a></div></li>
<li><div class="menu-item"><a class="class" href="../../../../Spah/SpahQL/Token/PathComponent/index.html" title="Spah.SpahQL.Token.PathComponent (class)">Spah.SpahQL.Token.PathComponent</a></div></li>
<li><div class="menu-item"><a class="class" href="../../../../Spah/SpahQL/Token/SelectionQuery/index.html" title="Spah.SpahQL.Token.SelectionQuery (class)">Spah.SpahQL.Token.SelectionQuery</a></div></li>
<li><div class="menu-item"><a class="class" href="../../../../Spah/SpahQL/Token/Set/index.html" title="Spah.SpahQL.Token.Set (class)">Spah.SpahQL.Token.Set</a></div></li>
<li><div class="menu-item"><a class="class" href="../../../../Spah/SpahQL/Token/Simple/index.html" title="Spah.SpahQL.Token.Simple (class)">Spah.SpahQL.Token.Simple</a></div></li>
<li><div class="menu-item"><a class="class" href="../../../../Spah/SpahQL/Token/String/index.html" title="Spah.SpahQL.Token.String (class)">Spah.SpahQL.Token.String</a></div></li></ul></li></ul></li>
<li><div class="menu-item"><a class="class current-parent" href="../../../../Spah/State/index.html" title="Spah.State (class)">Spah.State</a></div><ul><li><div class="menu-item"><a class="constructor" href="../../../../Spah/State/new/index.html" title="new Spah.State (constructor)">new</a></div></li>
<li><div class="menu-item"><a class="instance-method" href="../../../../Spah/State/prototype/addExpander/index.html" title="Spah.State#addExpander (instance method)">addExpander</a></div></li>
<li><div class="menu-item"><a class="instance-method current" href="../../../../Spah/State/prototype/addReducer/index.html" title="Spah.State#addReducer (instance method)">addReducer</a></div></li>
<li><div class="menu-item"><a class="instance-method" href="../../../../Spah/State/prototype/apply/index.html" title="Spah.State#apply (instance method)">apply</a></div></li>
<li><div class="menu-item"><a class="instance-method" href="../../../../Spah/State/prototype/applyKeepReducer/index.html" title="Spah.State#applyKeepReducer (instance method)">applyKeepReducer</a></div></li>
<li><div class="menu-item"><a class="instance-method" href="../../../../Spah/State/prototype/applyReducer/index.html" title="Spah.State#applyReducer (instance method)">applyReducer</a></div></li>
<li><div class="menu-item"><a class="instance-method" href="../../../../Spah/State/prototype/applyRemoveReducer/index.html" title="Spah.State#applyRemoveReducer (instance method)">applyRemoveReducer</a></div></li>
<li><div class="menu-item"><a class="instance-method" href="../../../../Spah/State/prototype/clone/index.html" title="Spah.State#clone (instance method)">clone</a></div></li>
<li><div class="menu-item"><a class="instance-method" href="../../../../Spah/State/prototype/expand/index.html" title="Spah.State#expand (instance method)">expand</a></div></li>
<li><div class="menu-item"><a class="instance-method" href="../../../../Spah/State/prototype/reduce/index.html" title="Spah.State#reduce (instance method)">reduce</a></div></li>
<li><div class="menu-item"><a class="instance-property" href="../../../../Spah/State/prototype/expanders/index.html" title="Spah.State#expanders (instance property)">expanders</a></div></li>
<li><div class="menu-item"><a class="instance-property" href="../../../../Spah/State/prototype/reducers/index.html" title="Spah.State#reducers (instance property)">reducers</a></div></li></ul></li>
<li><div class="menu-item"><a class="class" href="../../../../Spah/StateClient/index.html" title="Spah.StateClient (class)">Spah.StateClient</a></div></li>
<li><div class="menu-item"><a class="class" href="../../../../Spah/StateServer/index.html" title="Spah.StateServer (class)">Spah.StateServer</a></div></li></ul></li></ul><!--- #api_menu =-->
      </div> <!-- .sidebar-pane -->
      <div class="sidebar-pane" id="search_pane">
        <ul id="search_results" class="search-results menu-items scrollable"></ul>
      </div> <!-- .sidebar-pane -->
    </div> <!-- #sidebar -->

    <div id="page">
      

      <div id="main" class="page-content">
        





<ul class="breadcrumbs clearfix">
  <li><a href="../../../../">Home</a></li>
  
    <li>&rarr; <a href="../../../../Spah/index.html" title="Spah (class)">Spah</a></li>
  
    <li>&rarr; <a href="../../../../Spah/State/index.html" title="Spah.State (class)">State</a></li>
  
    <li>&rarr; <a href="../../../../Spah/State/prototype/addReducer/index.html" title="Spah.State#addReducer (instance method)">addReducer</a></li>
  
</ul>


  <p id="src_code_href"><a href="http://github.com/danski/spah/blob/master/src/Spah.State.js#163">src code</a></p>


<h2 class="page-title">
  <span class="type">instance method</span> Spah.State#addReducer
</h2>




<div class="section">
  <div class="section-title">
  </div> <!-- .section-title -->
  <div class="section-content">
    <div class="method-description">
      
        <pre class="syntax"><code class="ebnf">Spah.State#addReducer(reducer) &rarr; <a href="../../../../Spah/State/index.html" title="Spah.State (class)">Spah.State</a></code></pre>

      

      <p>reducer (Object): A hash containing the reducer properties. Should contain keys (&#8220;path&#8221; or &#8220;paths&#8221;) and (&#8220;keep&#8221; or &#8220;remove&#8221;).</p>

<p>Adds a new reducer strategy to this state. Reducer strategies are used to shrink the state so that only the necessary data is sent up the wire to the Spah Server.</p>

<p>Whenever the Spah Client makes a request to the Spah Server, a reduced version of the state is sent along with the request, allowing the server to make decisions based on the current UI state. You should specify how the state is reduced by using this method to add reducer strategies.</p>

<p>A reducer is a hash made up of one or more paths that you want to reduce, and a set of keys that you either want removed from those paths or a set of keys that should be kept while all other keys are removed. All the queries involved are selection queries, not assertions.</p>

<p>Here&#8217;s some examples:</p>

<p>// Remove /tweets from the root {&#8220;path&#8221;: &#8221;/&#8221;, &#8220;remove&#8221;: &#8220;/tweets&#8221;}</p>

<p>// Remove anything that contains a key &#8220;type&#8221; with value &#8220;tweet&#8221; {&#8220;path&#8221;: &#8221;/&#8221;, &#8220;remove&#8221;: &#8220;//<em><span>/type==&#8217;tweet&#8217;</span>&#8221;}</em></p>

<p>// Find everything with type=tweet and reduce it to only the &#8220;id&#8221; and &#8220;type&#8221; keys {&#8220;path&#8221;: &#8220;//<em><span>/type==&#8217;tweet&#8217;</span>&#8221;, &#8220;keep&#8221;: <span>&#8220;/id&#8221;, &#8220;/type&#8221;</span>}</em></p>

<p>// Keep only the first item in the arrays at /mentions and /direct_messages {&#8220;paths&#8221;: <span>&#8220;/mentions&#8221;, &#8220;/direct_messages&#8221;</span>, &#8220;keep&#8221;: &#8220;/0&#8221;}</p>

<p>// Keep only entries that are tweets any entry containing a tweet at any level {&#8220;paths&#8221;: &#8220;//<em>&#8221;, &#8220;keep&#8221;: &#8220;/</em><span>/type==&#8217;tweet&#8217;</span>&#8221;}</p>

<p>The mechanism uses the basic SpahQL helpers - a set of results to reduce is selected based on the &#8220;path&#8221; or &#8220;paths&#8221; key, and then if the reducer specifies a &#8220;keep&#8221; key, all entries <em>except</em> those matching one or more of the &#8220;keep&#8221; queries are destroyed. If the reducer specifies a &#8220;remove&#8221; key, all entries matching one or more of the &#8220;remove&#8221; queries are destroyed.</p>

<p>Call state.reduce() to run your reducers. Reducers are run in the order in which you added them.</p>

<p>The &#8220;keep&#8221; and &#8220;remove&#8221; keys are mutually exclusive, and using both in the same reducer will throw an error. If for some reason you specify both &#8220;path&#8221; and &#8220;paths&#8221;, &#8220;paths&#8221; will take priority and &#8220;path&#8221; will be ignored.</p>

<p>This method returns this state instance so that you may chain addReducer calls.</p>
      
      




      
    </div>
  </div> <!-- .section-content -->
</div> <!-- .section -->

      </div> <!-- #main -->
      
      <div id="footer">
        <p><a href="http://github.com/danski/spah">Spah</a> v0.0.0 API documentation.</p>
        <p>
          
            Last updated on March 07, 2012 at 11:40 UTC.
          
          Generated by <a href="http://pdoc.org">PDoc</a>.
          Uses <a href="http://famfamfam.com/lab/icons/silk/" title="famfamfam.com: Silk Icons">Silk Icons</a> and portions of <a href="http://github.com/280north/aristo/tree/master" title="280north's aristo at master - GitHub">Aristo</a>.
        </p>
        
      </div> <!-- #footer -->

    </div> <!-- #page -->
  </body>
</html>
